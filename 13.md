# Chapter 13. 까다로운 테스트.

모든 유닛테스트가 테스트하기 쉬운것은 아님!<p>
특정 코드는 테스트하기 까다로움. <p>
함 보자

 ## 멀티스레드 코드 테스트
- 동시성 코드를 작성하는것은 훨씬 어렵다.
- 동시성 처리가 필요한 앱의 코드를 테스트하는 것은 기술적으로 **유닛테스트의 영역이 아님**. 통합테스트로 분류하는것이 좋다.
- 스레드를 사용하는 코드에 대한 테스트는 느린 경향이 있음. 
이걸 해결 해보자


### 단순하고 똑똑하게 유지
멀티스레드 코드를 테스트 할때는 다음 주제를 따를 것
- **스레드 통제와 앱 코드 사이의 중첩을 최소화** : 스레드 없이 많은 앱 코드를 테스트 할 수 있도록 설계를 변경하삼. 
- **다른 사람의 작업을 믿을 것** : ??BlockingQueue클래스를 사용하세요?


### 데이터 문제
- 진짜 DB와 상호작용하는 통합 테스트를 작성 할 때, 먼저 적절한 데이터를 넣거나 이미 이러한 데이터가 DB에 있다고 가정해야한다. 
- 하지만 DB는 계속 변하므로 결국에는 테스트가 망가지게된다. 테스트코드와 데이터를 분리시키면 테스트가 통과/실패하는 이유를 이해하기 어려워짐.
- 테스트관점에서 데이터의 의미는 모두 DB에 넣는 순간 사라짐.
- **즉 테스트 안에서 데이터를 생성하고 관리해야함**
- 우리의 DB가 아니라면 @before나 @After에서 트랜잭션 처리를 하게 할 것.

### 요약
- 관심사를 분리할 것 : 애플리케이션 로직은 문제를 일으킬 수 있는 다른 의존성과 분리할 것. 의존적인 코드는 고립시킬것.
- 느리거나 휘발적인 코드를 Mock으로 교체하여 유닛 테스트의 의존성을 끊을 것.
- 필요한 경우 통합 테스트를 작성 하되, 단순하고 집중적으로 만들 것.


